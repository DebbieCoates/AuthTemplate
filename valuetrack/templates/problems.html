{% extends 'base.html' %}
{% load static %}

{% block content %}
  {% if user.is_superuser %} problems.html {% endif %}

  <h2>Issues</h2>

  <!-- Add Problem Button -->
  <div class="mt-4 text-end">
    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addProblemModal">
      Add Problem
    </button>
  </div>

  <!-- Problems Table -->
  <table class="table table-striped table-hover table-bordered mt-3">
    <thead>
      <tr>
        <th>Title</th>
        <th>Customer</th>
        <th>Status</th>
        <th>Urgency</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
{% for wrapped in problems %}
  {% with problem=wrapped.problem form=wrapped.form %}
    <tr>
      <td><a href="{% url 'problem' problem.id %}">{{ problem.title }}</a></td>
      <td><a href="{% url 'customer' problem.customer.id %}">{{ problem.customer }}</a></td>
      <td>{{ problem.status }}</td>
      <td>{{ problem.urgency }}</td>
      <td>{{ problem.created_at|date:"d/m/Y" }}</td>
      <td>
        <a href="#" data-bs-toggle="modal" data-bs-target="#editProblemModal{{ problem.id }}">Edit</a> &nbsp; | &nbsp;
        <a href="{% url 'problem_delete' problem.id %}">Delete</a>
      </td>
    </tr>

    {% include 'edit_problem_modal.html' %}
  {% endwith %}
{% endfor %}

    </tbody>
  </table>


{% include 'add_problem_modal.html' %}
 
{% endblock %}